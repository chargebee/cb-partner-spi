{
  "$schema": "http://json-schema.org/draft-06/schema#",
  "$ref": "#/definitions/ProviderCapabilitySchema",
  "definitions": {
    "ProviderCapabilitySchema": {
      "type": "object",
      "description": "The main schema that defines the structure of both E-invoicing Provider's production and sandbox capabilities.",
      "additionalProperties": false,
      "properties": {
        "prod": {
          "$ref": "#/definitions/CapabilityBody"
        },
        "sandbox": {
          "$ref": "#/definitions/CapabilityBody"
        }
      },
      "required": [
        "prod",
        "sandbox"
      ],
      "title": "ProviderCapabilitySchema"
    },
    "CapabilityBody": {
      "type": "object",
      "description": "Specifies the capabilities and configurations of the E-invoicing Provider for a given environment (e.g., production or sandbox).",
      "additionalProperties": false,
      "properties": {
        "identity_configuration": {
          "$ref": "#/definitions/IdentityConfiguration",
          "description": "Specifies Identity Configuration details of the E-invoicing provider such as Logo url, description, compliance related details."
        },
        "api_configuration": {
          "$ref": "#/definitions/APIConfiguration",
          "description": "Specifies API configuration details of the E-invoicing provider including the base URL and any necessary credentials."
        },
        "capabilities": {
          "$ref": "#/definitions/Capabilities",
          "description": "Specifies the capabilities supported by the E-invoicing provider with additional details such as supported countries and currencies."
        },
        "supported_number_of_line_items": {
          "type": "integer",
          "description": "Specifies the supported number of line items in an invoice or a credit note.",
          "examples": [
            1200
          ]
        },
        "version": {
          "type": "string",
          "description": "Specifies the Semantic Versioning of the schema.",
          "examples": [
            "1.0.0"
          ]
        }
      },
      "required": [
        "api_configuration",
        "capabilities",
        "identity_configuration",
        "supported_number_of_line_items",
        "version"
      ],
      "title": "Prod"
    },
    "APIConfiguration": {
      "type": "object",
      "description": "Specifies API configuration details of the E-invoicing provider including the base URL and any necessary credentials.",
      "additionalProperties": false,
      "properties": {
        "api_base_url": {
          "type": "string",
          "description": "Specifies the E-invoicing provider's Base URL.",
          "format": "uri",
          "qt-uri-protocols": [
            "https"
          ],
          "examples": [
            "https://api.einvoice-provider.com/integrations/chargebee/api/v1"
          ]
        },
        "credential_configuration": {
          "type": "array",
          "description": "Specifies the list of parameters that the E-invoicing provider needs for authentication & authorization.",
          "items": {
            "$ref": "#/definitions/CredentialConfiguration"
          }
        }
      },
      "required": [
        "api_base_url",
        "credential_configuration"
      ],
      "title": "APIConfiguration"
    },
    "CredentialConfiguration": {
      "type": "object",
      "description": "Specifies the list of parameters that the E-invoicing provider needs for authentication & authorization.",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Specifies the parameter name that the E-invoicing provider expects.",
          "examples": [
            "api_key"
          ]
        },
        "name": {
          "type": "string",
          "description": "Specifies the name to be displayed for the E-invoicing provider app in Chargebee platform.",
          "examples": [
            "E-invoice Provider API Key"
          ]
        },
        "type": {
          "type": "string",
          "description": "Specifies the type of the parameter.",
          "enum": [
            "text",
            "password"
          ]
        },
        "is_sensitive": {
          "type": "boolean",
          "description": "Specifies the the case sensitivity of the parameter."
        },
        "is_required": {
          "type": "boolean",
          "description": "Specifies if the E-invoicing provider expects this parameter mandatorily."
        }
      },
      "required": [
        "id",
        "is_required",
        "is_sensitive",
        "name",
        "type"
      ],
      "title": "CredentialConfiguration"
    },
    "Capabilities": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "supported_countries": {
          "type": "array",
            "items": {
                "type": "string"
                },
            "examples": [
                "DE", "AT", "FR", "IT", "ES", "NL", "PL", "PT", "SE", "FI", "NO", "DK", "BE"
            ],
          "description": "Specifies the countries(ISO 3166 alpha-2 country code format) supported by the E-invoicing provider."
        },
        "supported_currencies": {
          "type": "array",
          "description": "Specifies the supported currencies(ISO 4217 format) by the E-invoicing provider for the E-invoicing capability",
          "items": {
            "type": "string"
          },
          "examples": [
            "USD", "EUR", "GBP", "AUD", "CAD", "JPY", "INR", "CNY", "BRL", "MXN"
          ]
        },
        "activation": {
          "type": "object",
          "description": "Specifies the activation related configuration for the E-invoicing provider.",
          "properties": {
            "remote_activation_supported": {
              "type": "boolean",
              "description": "Specifies if setting up activation on E-invoice provider portal via Chargebee is supported."
            },
            "retrieve_activation_supported": {
              "type": "boolean",
              "description": "Specifies if retrieving activation info from E-invoice provider portal via Chargebee is supported."
            }
          },
          "required": [
            "remote_activation_supported",
            "retrieve_activation_supported"
          ]
        },
        "retrieve_mandates_supported": {
          "type": "boolean",
          "description": "Specifies if fetching mandates for countries is supported."
        },
        "retrieve_einvoice_status_supported": {
          "type": "boolean",
          "description": "Specifies if fetching e-invoice status for a given invoice is supported."
        },
        "customer_identifiers": {
          "$ref": "#/definitions/CustomerIdentifiers",
          "description": "Specifies the customer identifiers required for E-invoicing in different countries."
        }
      },
      "required": [
        "supported_countries",
        "supported_currencies",
        "activation",
        "retrieve_mandates_supported",
        "retrieve_einvoice_status_supported",
        "customer_identifiers"
      ],
      "title": "Capabilities"
    },
    "CustomerIdentifiers": {
      "type": "array",
      "description": "Specifies the customer identifiers required for E-invoicing in different countries.",
      "items": {
        "$ref": "CustomerIdentifier"
      },
      "examples": [
        {
          "external_id": "vat_number",
          "display_name": "Vat Number",
          "is_mandatory": true,
          "is_default": false,
          "field_type": "text",
          "supported_countries": [
            "DE",
            "AT"
          ]
        }
      ]
    },
    "CustomerIdentifier": {
      "type": "object",
      "description": "Specifies the e-invoicing identifier for the customer and the countries where it is required.",
      "additionalProperties": false,
      "properties": {
        "external_id": {
          "type": "string",
          "description": "Specifies the parameter name the E-invoicing provider expects.",
          "example": [
            "vat_number"
          ]
        },
        "display_name": {
          "type": "string",
          "description": "Specifies the name of the parameter to be displayed in Chargebee platform.",
          "example": [
            "Vat Number"
          ]
        },
        "is_mandatory": {
          "type": "boolean",
          "description": "Specifies if the parameter is mandatory."
        },
        "is_default": {
          "type": "boolean",
          "deprecated": true,
          "description": "Specifies if the parameter has a default value."
        },
        "field_type": {
          "type": "string"
        },
        "applicable_countries": {
          "type": "array",
          "description": "Specifies the countries(ISO 3166 alpha-2 country code format) which require this identifier",
          "items": {
            "type": "string"
          },
          "examples": [
            "DE"
          ]
        }
      },
      "required": [
        "display_name",
        "external_id",
        "field_type",
        "applicable_countries"
      ],
      "title": "CustomerIdentifier"
    },
    "IdentityConfiguration": {
      "type": "object",
      "description": "Specifies Identity Configuration details of the E-invoicing provider such as Logo url, description, compliance related details.",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Specifies the identifier of the E-invoicing provider"
        },
        "type": {
          "type": "array",
          "description": "Specifies the list of the features that the E-invoicing provider supports. In the case of E-invoicing Integration this would be E_INVOICING",
          "items": {
            "type": "string",
            "enum": [
              "E_INVOICING"
            ]
          }
        },
        "display_name": {
          "type": "string",
          "description": "Specifies the display name of the E-invoicing provider in Chargebee platform.",
          "examples": [
            "Anrok"
          ]
        },
        "logo_url": {
          "type": "string",
          "description": "Specifies the logo url of the E-invoicing provider to display in Chargebee platform.",
          "format": "uri",
          "qt-uri-protocols": [
            "https"
          ],
          "qt-uri-extensions": [
            ".png"
          ]
        },
        "primary_description": {
          "type": "array",
          "description": "Specifies the primary description of the E-invoicing provider.",
          "items": {
            "type": "string"
          }
        },
        "secondary_description": {
          "type": "array",
          "description": "Specifies the secondary description of the E-invoicing provider.",
          "items": {
            "type": "string"
          }
        },
        "signup_url": {
          "type": "string",
          "description": "Specifies the url for the merchant to sign up with the E-invoicing provider.",
          "format": "uri",
          "qt-uri-protocols": [
            "https"
          ]
        },
        "consent_policy_url": {
          "type": "string",
          "description": "Specifies the url about the consent related details of the E-invoicing provider for the merchant."
        },
        "privacy_policy_url": {
          "type": "string",
          "description": "Specifies the url about the privacy related details of the E-invoicing provider for the merchant."
        },
        "terms_of_service_url": {
          "type": "string",
          "description": "Specifies the url about the terms of services related details of the E-invoicing provider for the merchant.",
          "format": "uri",
          "qt-uri-protocols": [
            "https"
          ]
        },
        "documentation_url": {
          "type": "string",
          "description": "Specifies the url about the documentation details of the E-invoicing provider for the merchant.",
          "format": "uri",
          "qt-uri-protocols": [
            "https"
          ],
          "qt-uri-extensions": [
            ".html"
          ]
        },
        "support_email": {
          "type": "string",
          "description": "Specifies the support email of the E-invoicing provider to reach out to incase of queries or escalations.",
          "format": "email"
        }
      },
      "required": [
        "consent_policy_url",
        "display_name",
        "documentation_url",
        "id",
        "type",
        "logo_url",
        "primary_description",
        "privacy_policy_url",
        "secondary_description",
        "signup_url",
        "support_email",
        "terms_of_service_url"
      ],
      "title": "IdentityConfiguration"
    }
  }
}