{
	"info": {
		"_postman_id": "ee7dc01c-c659-4fb8-980b-f3fc69bcf186",
		"name": "Tax Compliance For all Tax Providers",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json",
		"_exporter_id": "19303335",
		"_collection_link": "https://chargebee.postman.co/workspace/Tax-team~9489def3-7902-4029-a8f5-de6410aa5bbf/collection/17920944-ee7dc01c-c659-4fb8-980b-f3fc69bcf186?action=share&source=collection_link&creator=19303335"
	},
	"item": [
		{
			"name": "TaxProvider",
			"item": [
				{
					"name": "Check Credentials with valid apikey",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Verify response code for check credentials with valid apikey\", function() {",
									"\tpm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Verify respone body status as valid\", () => {",
									"\tconst responseJson = pm.response.json();",
									"\tpm.expect(responseJson.status).to.be.eql('VALID');",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"status\"",
									"    ],",
									"    \"properties\": {",
									"        \"status\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The status Schema\"",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify schema for Credentials Validate\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"url": "https://{{url}}/credentials/validate"
					},
					"response": []
				},
				{
					"name": "Check Credentials with invalid apikey",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Verify response code for check credentials with invalid apikey\", function() {",
									"    pm.response.to.have.status(401);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{\"api_key\":\"s7tt9sxgac6/si4y969m7nux/secret.259s83dfkj5ec7jtxwiidrud\"}",
								"type": "text"
							}
						],
						"url": "https://{{url}}/credentials/validate"
					},
					"response": []
				},
				{
					"name": "Tax estimate with a plan",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i] / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for tax estimate\", function() {",
									"\tpm.response.to.have.status(200);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"        pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"        if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\t    pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"\t\t}",
									"        pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"\t    pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"\t",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"\t    pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"estimateDateTime\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"estimateDateTime\": \"2023-05-08T14:35:47.1Z\",\n    \"currency\": \"{{currency}}\",\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"{{itemCode}}\",\n            \"description\": \"CB-Flat-Fee-Plan\",\n            \"unitPrice\": {{line_item_unit_price}},\n            \"quantity\": {{line_item_quantity}},\n            \"amount\": {{line_item_amount}},\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"isTaxInclusive\": false,\n            \"taxIdentifiers\":[\n            {\n                \"id\":\"productCode\",\n                \"value\":\"GOODS\"\n            }]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/tax-estimate"
					},
					"response": []
				},
				{
					"name": "Tax estimate with a plan & addon with discounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_unit_price\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \" + lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \" + lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i] / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tdiscountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Validate tax estimate status code\", function() {",
									"\tpm.response.to.have.status(200);",
									"\tconsole.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Validate tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"        pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"\t\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\t    pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"\t\t}",
									"        pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"\t    pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"\t    pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"estimateDateTime\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [20,15]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [5,4]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\",\"CB-Flat-Fee-Addon-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\")), pm.collectionVariables.get(\"line_item_unit_price\")[1] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_unit_price\"+i, pm.collectionVariables.get(\"line_item_unit_price\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_unit_price\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_discount_amount\"+i, pm.collectionVariables.get(\"line_item_discount_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_discount_amount\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"itemCode\"+i, pm.collectionVariables.get(\"itemCode\")[i]);",
									"    console.log(pm.collectionVariables.get(\"itemCode\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_amount\"+i, pm.collectionVariables.get(\"line_item_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_amount\"+i));",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"estimateDateTime\": \"2022-11-14T09:35:47.1Z\",\n    \"currency\": \"{{currency}}\",\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"{{itemCode0}}\",\n            \"description\": \"CB-Flat-Fee-Plan\",\n            \"unitPrice\": {{line_item_unit_price0}},\n            \"quantity\": {{line_item_quantity}},\n            \"amount\": {{line_item_amount0}},\n            \"discountAmount\": {{line_item_discount_amount0}},\n            \"isTaxInclusive\": false\n        },\n        {\n            \"number\": 2,\n            \"itemCode\": \"{{itemCode1}}\",\n            \"description\": \"CB-Flat-Fee-Addon\",\n            \"unitPrice\": {{line_item_unit_price1}},\n            \"quantity\": {{line_item_quantity}},\n            \"amount\": {{line_item_amount1}},\n            \"discountAmount\": {{line_item_discount_amount1}},\n            \"isTaxInclusive\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/tax-estimate"
					},
					"response": []
				},
				{
					"name": "Tax estimate for a customer with vat number and a plan",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i] / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for tax estimate\", function() {",
									"\tpm.response.to.have.status(200);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"        if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"\t\t    pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\t    pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"\t\t}",
									"        pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"",
									"\tpm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(pm.collectionVariables.get(\"seller_taxreg_num\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"\t",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"\tpm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(pm.collectionVariables.get(\"customer_taxreg_num\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"estimateDateTime\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        },\n        \"taxRegistrationNumber\": \"{{seller_taxreg_num}}\"\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"taxRegistrationNumber\": \"{{customer_taxreg_num}}\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"estimateDateTime\": \"2022-11-14T09:35:47.1Z\",\n    \"currency\": \"{{currency}}\",\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"{{itemCode}}\",\n            \"description\": \"CB-Flat-Fee-Plan\",\n            \"unitPrice\": {{line_item_unit_price}},\n            \"quantity\": {{line_item_quantity}},\n            \"amount\": {{line_item_amount}},\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"isTaxInclusive\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/tax-estimate"
					},
					"response": []
				},
				{
					"name": "Tax estimate with per unit plan and discounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \" + lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \" + lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i] / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tdiscountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Validate tax estimate status code\", function() {",
									"\tpm.response.to.have.status(200);",
									"\tconsole.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Validate tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"\t\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\t    pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"\t\t}",
									"        pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"\t    pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"\t    pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"estimateDateTime\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [20]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [10]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Per-Unit-Plan-USD-Monthly\"]);",
									"",
									"pm.collectionVariables.set(\"line_item_quantity\", 2.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"estimateDateTime\": \"2022-11-14T09:35:47.1Z\",\n    \"currency\": \"{{currency}}\",\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"{{itemCode}}\",\n            \"description\": \"CB-Per-Unit-Plan\",\n            \"quantity\": {{line_item_quantity}},\n            \"unitPrice\": {{line_item_unit_price}},\n            \"amount\": {{line_item_amount}},\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"isTaxInclusive\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/tax-estimate"
					},
					"response": []
				},
				{
					"name": "Tax estimate with a plan and 100% discounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"var taxRate = pm.environment.get(\"exemptTaxRate\");",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRate / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for tax estimate\", function() {",
									"\tpm.response.to.have.status(200);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(false);",
									"        pm.expect(lineItems[i].taxExemptType).to.be.eql('ZERO_VALUE_ITEM');",
									"        pm.expect(lineItems[i].taxExemptReason).to.be.eql('not collecting tax because total is zero');",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].rate).to.be.eql(0);",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\t\tpm.expect(taxes[j].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.eql(pm.environment.get(\"jurisdictionName\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.eql(pm.environment.get(\"jurisdictionCode\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.eql(pm.environment.get(\"jurisdictionType\")[j]);",
									"\t\t}",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"",
									"\tpm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"\tpm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"\tpm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"\tpm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\",",
									"        \"estimateDateTime\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"customerCode\",",
									"                \"address\",",
									"                \"taxRegistrationNumber\",",
									"                \"hasNexus\"",
									"            ],",
									"            \"properties\": {",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                },",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"line1\",",
									"                        \"line2\",",
									"                        \"line3\",",
									"                        \"city\",",
									"                        \"state\",",
									"                        \"postalCode\",",
									"                        \"country\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"line2\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line2 Schema\"",
									"                        },",
									"                        \"line3\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line3 Schema\"",
									"                        },",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"taxRegistrationNumber\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The taxRegistrationNumber Schema\"",
									"                },",
									"                \"hasNexus\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The hasNexus Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"number\",",
									"                    \"itemCode\",",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"subtotal\",",
									"                    \"exemptAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxAmount\",",
									"                    \"total\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"taxExemptType\",",
									"                    \"taxExemptReason\",",
									"                    \"taxes\"",
									"                ],",
									"                \"properties\": {",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"taxExemptType\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The taxExemptType Schema\"",
									"                    },",
									"                    \"taxExemptReason\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The taxExemptReason Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"number\",",
									"                                \"name\",",
									"                                \"rate\",",
									"                                \"taxableAmount\",",
									"                                \"taxAmount\",",
									"                                \"jurisdiction\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"default\": 0,",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"default\": 0.0,",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"default\": 0,",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"default\": 0.0,",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"default\": {},",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"name\",",
									"                                        \"code\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"default\": \"\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"default\": \"\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"default\": \"\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                }",
									"                            }",
									"                        }",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"taxRegistrationNumber\",",
									"                \"hasNexus\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"line1\",",
									"                        \"line2\",",
									"                        \"line3\",",
									"                        \"city\",",
									"                        \"state\",",
									"                        \"postalCode\",",
									"                        \"country\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"line2\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line2 Schema\"",
									"                        },",
									"                        \"line3\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line3 Schema\"",
									"                        },",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"taxRegistrationNumber\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The taxRegistrationNumber Schema\"",
									"                },",
									"                \"hasNexus\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The hasNexus Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\"",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\"",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\"",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [10]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"estimateDateTime\": \"2022-11-14T09:35:47.1Z\",\n    \"currency\": \"{{currency}}\",\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"{{itemCode}}\",\n            \"description\": \"CB-Flat-Fee-Plan\",\n            \"unitPrice\": {{line_item_unit_price}},\n            \"quantity\": {{line_item_quantity}},\n            \"amount\": {{line_item_amount}},\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"isTaxInclusive\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/tax-estimate"
					},
					"response": []
				},
				{
					"name": "Tax estimate with tax exempt items",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"var taxRate = pm.environment.get(\"exemptTaxRate\");",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRate / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"",
									"pm.test(\"Verify response code for tax estimate\", function() {",
									"\tpm.response.to.have.status(200);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(0);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(false);",
									"        pm.expect(lineItems[i].taxExemptType).to.be.eql('PRODUCT_EXEMPT');",
									"        pm.expect(lineItems[i].taxExemptReason).to.be.eql('not collecting tax for product');",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].rate).to.be.eql(0);",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(0);",
									"\t\t\tpm.expect(taxes[j].taxAmount).to.be.eql(0);",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.eql(pm.environment.get(\"jurisdictionName\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.eql(pm.environment.get(\"jurisdictionCode\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.eql(pm.environment.get(\"jurisdictionType\")[j]);",
									"\t\t}",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"",
									"\tpm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"\tpm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"\tpm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"\tpm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"});",
									"",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\",",
									"        \"estimateDateTime\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"customerCode\",",
									"                \"address\",",
									"                \"taxRegistrationNumber\",",
									"                \"hasNexus\"",
									"            ],",
									"            \"properties\": {",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                },",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"line1\",",
									"                        \"line2\",",
									"                        \"line3\",",
									"                        \"city\",",
									"                        \"state\",",
									"                        \"postalCode\",",
									"                        \"country\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"line2\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line2 Schema\"",
									"                        },",
									"                        \"line3\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line3 Schema\"",
									"                        },",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"taxRegistrationNumber\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The taxRegistrationNumber Schema\"",
									"                },",
									"                \"hasNexus\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The hasNexus Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"number\",",
									"                    \"itemCode\",",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"subtotal\",",
									"                    \"exemptAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxAmount\",",
									"                    \"total\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"taxExemptType\",",
									"                    \"taxExemptReason\",",
									"                    \"taxes\"",
									"                ],",
									"                \"properties\": {",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"taxExemptType\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The taxExemptType Schema\"",
									"                    },",
									"                    \"taxExemptReason\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The taxExemptReason Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"number\",",
									"                                \"name\",",
									"                                \"rate\",",
									"                                \"taxableAmount\",",
									"                                \"taxAmount\",",
									"                                \"jurisdiction\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"default\": 0,",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"default\": 0.0,",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"default\": 0,",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"default\": 0.0,",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"default\": {},",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"name\",",
									"                                        \"code\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"default\": \"\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"default\": \"\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"default\": \"\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                }",
									"                            }",
									"                        }",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"taxRegistrationNumber\",",
									"                \"hasNexus\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"line1\",",
									"                        \"line2\",",
									"                        \"line3\",",
									"                        \"city\",",
									"                        \"state\",",
									"                        \"postalCode\",",
									"                        \"country\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"line2\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line2 Schema\"",
									"                        },",
									"                        \"line3\": {",
									"                            \"type\": \"null\",",
									"                            \"default\": null,",
									"                            \"title\": \"The line3 Schema\"",
									"                        },",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"taxRegistrationNumber\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The taxRegistrationNumber Schema\"",
									"                },",
									"                \"hasNexus\": {",
									"                    \"type\": \"null\",",
									"                    \"default\": null,",
									"                    \"title\": \"The hasNexus Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\"",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\"",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\"",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate with exempt items response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10,20]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0,0]);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\")), pm.collectionVariables.get(\"line_item_unit_price\")[1] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Exempt-Plan\",\"CB-Flat-Fee-Exempt-Addon\"]);",
									"pm.collectionVariables.set(\"taxRate\", 0);",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_unit_price\"+i, pm.collectionVariables.get(\"line_item_unit_price\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_unit_price\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_discount_amount\"+i, pm.collectionVariables.get(\"line_item_discount_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_discount_amount\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"itemCode\"+i, pm.collectionVariables.get(\"itemCode\")[i]);",
									"    console.log(pm.collectionVariables.get(\"itemCode\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_amount\"+i, pm.collectionVariables.get(\"line_item_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_amount\"+i));",
									"}",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"estimateDateTime\": \"2022-11-14T09:35:47.1Z\",\n    \"currency\": \"{{currency}}\",\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"{{itemCode0}}\",\n            \"description\": \"CB-Flat-Fee-Exempt-Plan\",\n            \"unitPrice\": {{line_item_unit_price0}},\n            \"quantity\": {{line_item_quantity}},\n            \"amount\": {{line_item_amount0}},\n            \"discountAmount\": {{line_item_discount_amount0}},\n            \"isTaxInclusive\": false\n        },\n        {\n            \"number\": 2,\n            \"itemCode\": \"{{itemCode1}}\",\n            \"description\": \"CB-Flat-Fee-Exempt-Addon\",\n            \"unitPrice\": {{line_item_unit_price1}},\n            \"quantity\": {{line_item_quantity}},\n            \"amount\": {{line_item_amount1}},\n            \"discountAmount\": {{line_item_discount_amount1}},\n            \"isTaxInclusive\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/tax-estimate"
					},
					"response": []
				},
				{
					"name": "Tax estimate with invalid address",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"",
									"pm.test(\"Verify response code for tax estimate\", function() {",
									"\tpm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Verify tax estimate response body\", () => {",
									"\tpm.expect(responseJson.errors[0].code).to.eql('INVALID_DATA');",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"errors\"",
									"    ],",
									"    \"properties\": {",
									"        \"errors\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The errors Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"code\",",
									"                    \"message\"",
									"                ],",
									"                \"properties\": {",
									"                    \"code\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The code Schema\"",
									"                    },",
									"                    \"message\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The message Schema\"",
									"                    }",
									"                }",
									"            }",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate with invalid address response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"",
									"pm.variables.set(\"customer_state\", \"OH\");",
									"pm.variables.set(\"customer_zip\", \"10255\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"state\": \"{{customer_state}}\",\n            \"postalCode\": \"{{customer_zip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"estimateDateTime\": \"2022-11-14T09:35:47.1Z\",\n    \"currency\": \"USD\",\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"{{itemCode}}\",\n            \"description\": \"CB-Flat-Fee-Plan\",\n            \"unitPrice\": {{line_item_unit_price}},\n            \"amount\": {{line_item_amount}},\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"isTaxInclusive\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/tax-estimate"
					},
					"response": []
				},
				{
					"name": "Create Invoice with single line item and validate response",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"pm.environment.set(\"invoiceId\", responseJson.invoiceId);",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i]/ 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for single line item invoice\", function() {",
									"\tpm.response.to.have.status(201);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify invoice response body\", () => ",
									"{",
									"    pm.expect(responseJson.invoiceCode).to.be.not.null;",
									"    pm.expect(responseJson.customerCode).to.be.not.null;",
									"    pm.expect(responseJson.total).to.eql(total);",
									"    pm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"    pm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"    pm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"    pm.expect(responseJson.documentDateTime).to.be.not.null;",
									"    pm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"    pm.expect(responseJson.exemptAmount).to.eql(0);",
									"    pm.expect(responseJson.status).to.eql(pm.collectionVariables.get(\"status\"));",
									"    pm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in invoice response\", function() {",
									"    for (let i = 0; i < lineItems.length; i++) {",
									"        pm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"        pm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"        pm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"        pm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"        pm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"        pm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"        pm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"        pm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"        pm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"        pm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"        if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) ",
									"        {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"            pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"        const taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            pm.expect(taxes[j].name).to.be.not.null;",
									"            pm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"            pm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"        }",
									"        pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in invoice response\", () => {",
									"    const sellerAddress = responseJson.seller.address;",
									"    pm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"    pm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"    pm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"    pm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"    pm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\"))",
									"    {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify customerAddress in invoice response\", () => {",
									"    const customerAddress = responseJson.customer.address;",
									"    pm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"    pm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"    pm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"    pm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"    pm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\"))",
									"    {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"",
									"",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"invoiceCode\": \"{{$randomAlphaNumeric}}\",\n    \"documentDateTime\": \"2022-01-01T01:01:01Z\",\n    \"currency\": \"USD\",\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"abcd\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"exemptAmount\": 0,\n    \"discountAmount\": 0,\n    \"subtotal\": 10,\n    \"taxAmount\": 0.89,\n    \"taxableAmount\": 10,\n    \"total\": 10.89,\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"amount\": {{line_item_amount}},\n            \"subtotal\": {{line_item_amount}},\n            \"exemptAmount\": 0,\n            \"itemCode\": \"{{itemCode}}\",\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"taxableAmount\": {{taxableAmount}},\n            \"taxAmount\": 0.89,\n            \"total\": {{total}},\n            \"isTaxInclusive\": false,\n            \"isTaxable\": true,\n            \"taxExemptType\": null,\n            \"taxExemptReason\": null,\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 8.9,\n                    \"taxableAmount\": 10,\n                    \"taxAmount\": 0.89,\n                    \"jurisdiction\": {\n                        \"name\": \"{{jurisdictionName}}\",\n                        \"code\": \"{{jurisdictionCode}}\",\n                        \"type\": \"{{jurisdictionType}}\"\n                    }\n                }\n            ]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/invoices"
					},
					"response": []
				},
				{
					"name": "Get Invoice ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"url": "https://{{url}}/invoices"
					},
					"response": []
				},
				{
					"name": "Create an invoice with a line item, discount and validate response",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i]/ 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for single line item invoice\", function() {",
									"\tpm.response.to.have.status(201);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify single line item invoice response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in single line item invoice response body\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"",
									"        if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\t    pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].rate).to.be.eql(Number((lineItemTaxAmount[i] * 100/lineItemTaxableAmount[i]).toFixed(2)));",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\t\tpm.expect(taxes[j].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.eql(pm.environment.get(\"jurisdictionName\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.eql(pm.environment.get(\"jurisdictionCode\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.eql(pm.environment.get(\"jurisdictionType\")[j]);",
									"\t\t}",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in single line item invoice response body\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"",
									"});",
									"",
									"pm.test(\"Verify customerAddress in single line item invoice response body\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [20]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [10]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Per-Unit-Plan-USD-Monthly\"]);",
									"",
									"pm.collectionVariables.set(\"line_item_quantity\", 2.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"invoiceCode\": \"{{$randomAlphaNumeric}}\",\n    \"documentDateTime\": \"2022-01-01T01:01:01Z\",\n    \"currency\": \"USD\",\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"exemptAmount\": 0,\n    \"discountAmount\": 10,\n    \"subtotal\": 30,\n    \"taxAmount\": 2.66,\n    \"taxableAmount\": 30,\n    \"total\": 32.66,\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"amount\": {{line_item_amount}},\n            \"subtotal\": 30,\n            \"exemptAmount\": 0,\n            \"itemCode\": \"CB-Per-Unit-Plan-USD-Monthly\",\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"taxableAmount\": 30,\n            \"taxAmount\": 2.66,\n            \"total\": 32.66,\n            \"isTaxInclusive\": false,\n            \"isTaxable\": true,\n            \"taxExemptType\": null,\n            \"taxExemptReason\": null,\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 8.87,\n                    \"taxableAmount\": 30,\n                    \"taxAmount\": 2.66,\n                    \"jurisdiction\": {\n                        \"name\": \"United States\",\n                        \"code\": \"US\",\n                        \"type\": \"COUNTRY\"\n                    }\n                }\n            ]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/invoices"
					},
					"response": []
				},
				{
					"name": "Create an invoice with multiple line items and validate response",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_unit_price\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \" + lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \" + lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < 2; i++)",
									" {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < 2; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i]/ 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < 2; i++) {",
									"\tdiscountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < 2; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < 2; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < 2; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Validate tax estimate status code\", function() {",
									"\tpm.response.to.have.status(201);",
									"\tconsole.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Validate tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++)",
									"     {",
									"",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"        if (pm.environment.get(\"currentEnvName\").has(\"Anrok\"))",
									"         {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"            pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"        const taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            pm.expect(taxes[j].name).to.be.not.null;",
									"            pm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"            pm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"            pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\t    pm.expect(taxes[j].jurisdiction.name).to.be.eql(pm.environment.get(\"jurisdictionName\")[j]);",
									"\t\t    pm.expect(taxes[j].jurisdiction.code).to.be.eql(pm.environment.get(\"jurisdictionCode\")[j]);",
									"\t\t    pm.expect(taxes[j].jurisdiction.type).to.be.eql(pm.environment.get(\"jurisdictionType\")[j]);",
									"\t\t}",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [20,15]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [5,4]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\",\"CB-Flat-Fee-Addon-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\")), pm.collectionVariables.get(\"line_item_unit_price\")[1] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_unit_price\"+i, pm.collectionVariables.get(\"line_item_unit_price\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_unit_price\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_discount_amount\"+i, pm.collectionVariables.get(\"line_item_discount_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_discount_amount\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"itemCode\"+i, pm.collectionVariables.get(\"itemCode\")[i]);",
									"    console.log(pm.collectionVariables.get(\"itemCode\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_amount\"+i, pm.collectionVariables.get(\"line_item_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_amount\"+i));",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"invoiceCode\": \"{{$randomAlphaNumeric}}\",\n    \"documentDateTime\": \"2022-01-01T01:01:01Z\",\n    \"currency\": \"USD\",\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"exemptAmount\": 0,\n    \"discountAmount\": 9,\n    \"subtotal\": 26,\n    \"taxAmount\": 2.31,\n    \"taxableAmount\": 26,\n    \"total\": 28.31,\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"CB-Flat-Fee-Plan-USD-Monthly\",\n            \"amount\": {{line_item_amount0}},\n            \"discountAmount\": {{line_item_discount_amount0}},\n            \"subtotal\": 15,\n            \"exemptAmount\": 0,\n            \"taxableAmount\": 15,\n            \"taxAmount\": 1.33,\n            \"total\": 16.33,\n            \"isTaxInclusive\": false,\n            \"isTaxable\": true,\n            \"taxExemptType\": null,\n            \"taxExemptReason\": null,\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 8.87,\n                    \"taxableAmount\": 15,\n                    \"taxAmount\": 1.33,\n                    \"jurisdiction\": {\n                        \"name\": \"United States\",\n                        \"code\": \"US\",\n                        \"type\": \"COUNTRY\"\n                    }\n                }\n            ]\n        },\n        {\n            \"number\": 2,\n            \"itemCode\": \"CB-Flat-Fee-Addon-USD-Monthly\",\n            \"amount\": {{line_item_amount1}},\n            \"discountAmount\": {{line_item_discount_amount1}},\n            \"subtotal\": 11,\n            \"exemptAmount\": 0,\n            \"taxableAmount\": 11,\n            \"taxAmount\": 0.98,\n            \"total\": 11.98,\n            \"isTaxInclusive\": false,\n            \"isTaxable\": true,\n            \"taxExemptType\": null,\n            \"taxExemptReason\": null,\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 8.91,\n                    \"taxableAmount\": 11,\n                    \"taxAmount\": 0.98,\n                    \"jurisdiction\": {\n                        \"name\": \"{{jurisdictionName}}\",\n                        \"code\": \"{{jurisdictionCode}}\",\n                        \"type\": \"{{jurisdictionType}}\"\n                    }\n                }\n            ]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/invoices"
					},
					"response": []
				},
				{
					"name": "Create an invoice for a customer with vat number, line item and validate response",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i] / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for tax estimate\", function() {",
									"\tpm.response.to.have.status(201);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify invoice for a customer with vat number, line item\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes for invoice for a customer with vat number, line item\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"\t\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"            pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            pm.expect(taxes[j].name).to.be.not.null;",
									"            pm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"            pm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"        ",
									"            pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.eql(pm.environment.get(\"jurisdictionName\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.eql(pm.environment.get(\"jurisdictionCode\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.eql(pm.environment.get(\"jurisdictionType\")[j]);",
									"\t\t}",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress for invoice for a customer with vat number, line item\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(pm.collectionVariables.get(\"seller_taxreg_num\"));",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify customerAddress for invoice for a customer with vat number, line item\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(pm.collectionVariables.get(\"customer_taxreg_num\"));",
									"        pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"invoiceCode\": \"{{$randomAlphaNumeric}}\",\n    \"documentDateTime\": \"2022-01-01T01:01:01Z\",\n    \"currency\": \"USD\",\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        },\n        \"taxRegistrationNumber\": \"{{seller_taxreg_num}}\"\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        },\n        \"taxRegistrationNumber\": \"12-3456789\"\n    },\n    \"exemptAmount\": 0,\n    \"discountAmount\": 0,\n    \"subtotal\": 10,\n    \"taxAmount\": 0.89,\n    \"taxableAmount\": 10,\n    \"total\": 10.89,\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"amount\": {{line_item_amount}},\n            \"subtotal\": {{subtotal}},\n            \"exemptAmount\": {{exemptAmount}},\n            \"itemCode\": \"CB-Flat-Fee-Plan-USD-Monthly\",\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"taxableAmount\": {{taxableAmount}},\n            \"taxAmount\": 0.89,\n            \"total\": {{total}},\n            \"isTaxInclusive\": false,\n            \"isTaxable\": true,\n            \"taxExemptType\": null,\n            \"taxExemptReason\": null,\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 8.9,\n                    \"taxableAmount\": {{taxableAmount}},\n                    \"taxAmount\": 0.89,\n                    \"jurisdiction\": {\n                        \"name\": \"{{jurisdictionName}}\",\n                        \"code\": \"{{jurisdictionCode}}\",\n                        \"type\": \"{{jurisdictionType}}\"\n                    }\n                }\n            ]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/invoices"
					},
					"response": []
				},
				{
					"name": "Create an invoice with zero amount (line item amount = discountAmount) and validate response",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"let taxRates = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    const taxes = lineItems[i].taxes;",
									"    var rate = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            rate += taxes[j].rate;",
									"        }",
									"        taxRates[i] = rate;",
									"}",
									"console.log(\"lineItem taxRates = \"+taxRates);",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRates[i] / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for invoice with amount equal to discount\", function() {",
									"\tpm.response.to.have.status(201);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify invoice for invoice with amount equal to discount\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(0);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes for invoice with amount equal to discount\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"        if (pm.environment.get(\"currentEnvName\").has(\"Anrok\"))",
									"         {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"            pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"",
									"        const taxes = lineItems[i].taxes;",
									"        var taxAmount = 0;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            pm.expect(taxes[j].name).to.be.not.null;",
									"            pm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            taxAmount += taxes[j].taxAmount;",
									"            pm.expect(taxes[j].jurisdiction.name).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.code).to.be.not.null;",
									"            pm.expect(taxes[j].jurisdiction.type).to.be.not.null;",
									"            pm.expect(taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.eql(pm.environment.get(\"jurisdictionName\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.eql(pm.environment.get(\"jurisdictionCode\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.eql(pm.environment.get(\"jurisdictionType\")[j]);",
									"\t\t}",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress for invoice with amount equal to discount\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(pm.collectionVariables.get(\"seller_taxreg_num\"));",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify customerAddress for invoice with amount equal to discount\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"",
									"\tif (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.customer.taxRegistrationNumber).to.be.eql(pm.collectionVariables.get(\"customer_taxreg_num\"));",
									"        pm.expect(responseJson.customer.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"invoiceCode\": \"{{$randomAlphaNumeric}}\",\n    \"documentDateTime\": \"2022-01-01T01:01:01Z\",\n    \"currency\": \"USD\",\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        },\n        \"taxRegistrationNumber\": \"123456789\"\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        },\n        \"taxRegistrationNumber\": \"12-3456789\"\n    },\n    \"exemptAmount\": 0,\n    \"discountAmount\": 0,\n    \"subtotal\": 10,\n    \"taxAmount\": 0.89,\n    \"taxableAmount\": 10,\n    \"total\": 10.89,\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"amount\": {{line_item_amount}},\n            \"subtotal\": {{subtotal}},\n            \"exemptAmount\": {{exemptAmount}},\n            \"itemCode\": \"CB-Flat-Fee-Plan-USD-Monthly\",\n            \"discountAmount\": {{line_item_amount}},\n            \"taxableAmount\": {{taxableAmount}},\n            \"taxAmount\": 0.89,\n            \"total\": {{total}},\n            \"isTaxInclusive\": false,\n            \"isTaxable\": true,\n            \"taxExemptType\": null,\n            \"taxExemptReason\": null,\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 8.9,\n                    \"taxableAmount\": {{taxableAmount}},\n                    \"taxAmount\": 0.89,\n                    \"jurisdiction\": {\n                        \"name\": \"{{jurisdictionName}}\",\n                        \"code\": \"{{jurisdictionCode}}\",\n                        \"type\": \"{{jurisdictionType}}\"\n                    }\n                }\n            ]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/invoices"
					},
					"response": []
				},
				{
					"name": "Create an invoice for tax exempt line items and validate response",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"var taxRate = pm.environment.get(\"exemptTaxRate\");",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\tlineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRate / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttotal += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"\ttaxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"",
									"pm.test(\"Verify response code for tax estimate\", function() {",
									"\tpm.response.to.have.status(201);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify tax estimate response body\", () => {",
									"\tpm.expect(responseJson.total).to.eql(total);",
									"\tpm.expect(responseJson.subtotal).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"\tpm.expect(responseJson.taxableAmount).to.eql(0);",
									"\tpm.expect(responseJson.estimateDateTime).to.be.not.null;",
									"\tpm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"\tpm.expect(responseJson.exemptAmount).to.eql(taxableAmount);",
									"\tpm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"));",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in tax estimate response\", function() {",
									"\tfor (let i = 0; i < lineItems.length; i++) {",
									"\t\tpm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"\t\tpm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"\t\tpm.expect(lineItems[i].exemptAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxableAmount).to.be.eql(0);",
									"\t\tpm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"\t\tpm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"\t\tpm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"\t\tpm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"\t\tpm.expect(lineItems[i].isTaxable).to.be.eql(false);",
									"        pm.expect(lineItems[i].taxExemptType).to.be.eql('PRODUCT_EXEMPT');",
									"        pm.expect(lineItems[i].taxExemptReason).to.be.eql('not collecting tax for product');",
									"",
									"\t\tconst taxes = lineItems[i].taxes;",
									"\t\tfor (let j = 0; j < taxes.length; j++) {",
									"\t\t\tpm.expect(taxes[j].name).to.be.not.null;",
									"\t\t\tpm.expect(taxes[j].rate).to.be.eql(0);",
									"\t\t\tpm.expect(taxes[j].taxableAmount).to.be.eql(0);",
									"\t\t\tpm.expect(taxes[j].taxAmount).to.be.eql(0);",
									"",
									"\t\t\tpm.expect(taxes[j].jurisdiction.name).to.be.eql(pm.environment.get(\"jurisdictionName\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.code).to.be.eql(pm.environment.get(\"jurisdictionCode\")[j]);",
									"\t\t\tpm.expect(taxes[j].jurisdiction.type).to.be.eql(pm.environment.get(\"jurisdictionType\")[j]);",
									"\t\t}",
									"\t}",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify tax estimate with exempt items response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10,20]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0,0]);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\")), pm.collectionVariables.get(\"line_item_unit_price\")[1] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Exempt-Plan\",\"CB-Flat-Fee-Exempt-Addon\"]);",
									"pm.collectionVariables.set(\"taxRate\", 0);",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_unit_price\"+i, pm.collectionVariables.get(\"line_item_unit_price\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_unit_price\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_discount_amount\"+i, pm.collectionVariables.get(\"line_item_discount_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_discount_amount\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"itemCode\"+i, pm.collectionVariables.get(\"itemCode\")[i]);",
									"    console.log(pm.collectionVariables.get(\"itemCode\"+i));",
									"}",
									"",
									"for (let i = 0; i < 2; i++) {",
									"    pm.variables.set(\"line_item_amount\"+i, pm.collectionVariables.get(\"line_item_amount\")[i]);",
									"    console.log(pm.collectionVariables.get(\"line_item_amount\"+i));",
									"}",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"invoiceCode\": \"{{$randomAlphaNumeric}}\",\n    \"documentDateTime\": \"2022-01-01T01:01:01Z\",\n    \"currency\": \"USD\",\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"exemptAmount\": 30,\n    \"discountAmount\": 0,\n    \"subtotal\": 30,\n    \"taxAmount\": 0,\n    \"taxableAmount\": 0,\n    \"total\": 30,\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"itemCode\": \"CB-Flat-Fee-Exempt-Plan\",\n            \"amount\": {{line_item_amount0}},\n            \"discountAmount\": {{line_item_discount_amount0}},\n            \"subtotal\": 10,\n            \"exemptAmount\": {{exemptAmount1}},\n            \"taxableAmount\": 0,\n            \"taxAmount\": 0,\n            \"total\": 10,\n            \"isTaxInclusive\": false,\n            \"isTaxable\": false,\n            \"taxExemptType\": \"PRODUCT_EXEMPT\",\n            \"taxExemptReason\": \"not collecting tax for product\",\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 0,\n                    \"taxableAmount\": 0,\n                    \"taxAmount\": 0,\n                    \"jurisdiction\": {\n                        \"name\": \"United States\",\n                        \"code\": \"US\",\n                        \"type\": \"COUNTRY\"\n                    }\n                }\n            ]\n        },\n        {\n            \"number\": 2,\n            \"itemCode\": \"CB-Flat-Fee-Exempt-Addon\",\n            \"amount\": {{line_item_amount1}},\n            \"discountAmount\": {{line_item_discount_amount1}},\n            \"subtotal\": 20,\n            \"exemptAmount\": {{exemptAmount2}},\n            \"taxableAmount\": 0,\n            \"taxAmount\": 0,\n            \"total\": 20,\n            \"isTaxInclusive\": false,\n            \"isTaxable\": false,\n            \"taxExemptType\": \"PRODUCT_EXEMPT\",\n            \"taxExemptReason\": \"not collecting tax for product\",\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"name\": \"Tax\",\n                    \"rate\": 0,\n                    \"taxableAmount\": 0,\n                    \"taxAmount\": 0,\n                    \"jurisdiction\": {\n                        \"name\": \"{{jurisdictionName}}\",\n                        \"code\": \"{{jurisdictionCode}}\",\n                        \"type\": \"{{jurisdictionType}}\"\n                    }\n                }\n            ]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/invoices"
					},
					"response": []
				},
				{
					"name": "Void Invoice",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Invoice is Voided\", function () {",
									"    pm.response.to.have.status(204);",
									"",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "invoiceId",
									"value": "{{invoiceId}}",
									"type": "text"
								}
							]
						},
						"url": "https://{{url}}/invoices/{{invoiceId}}/void"
					},
					"response": []
				},
				{
					"name": "Create credit note",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"const lineItems = responseJson.lineItems;",
									"",
									"pm.environment.set(\"creditNoteId\", responseJson.creditNoteId);",
									"",
									"var taxRate = pm.environment.get(\"taxRate\");",
									"",
									"let lineItemAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_amount\"), (k) => lineItemAmount.push(k))",
									"pm.variables.set(\"lineItemAmount\", JSON.stringify(lineItemAmount))",
									"console.log(\"lineItemAmount = \"+lineItemAmount);",
									"",
									"let lineItemDiscountAmount = []",
									"_.each(pm.collectionVariables.get(\"line_item_discount_amount\"), (k) => lineItemDiscountAmount.push(k))",
									"pm.variables.set(\"lineItemDiscountAmount\", JSON.stringify(lineItemDiscountAmount))",
									"console.log(\"lineItemDiscountAmount = \"+lineItemDiscountAmount);",
									"",
									"let lineItemTaxableAmount = [];",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxableAmount[i] = lineItemAmount[i] - lineItemDiscountAmount[i];",
									"}",
									"console.log(\"lineItemTaxableAmount = \"+ lineItemTaxableAmount);",
									"",
									"let lineItemTaxAmount = []",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    lineItemTaxAmount[i] = Number((lineItemTaxableAmount[i] * (taxRate / 100)).toFixed(2));",
									"}",
									"console.log(\"lineItemTaxAmount = \" + lineItemTaxAmount);",
									"",
									"var discountAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    discountAmount += lineItemDiscountAmount[i];",
									"}",
									"console.log(\"discountAmount = \" + discountAmount);",
									"",
									"var total = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    total += (lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"}",
									"console.log(\"total = \" + total);",
									"",
									"var taxableAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    taxableAmount += (lineItemAmount[i] - lineItemDiscountAmount[i]);",
									"}",
									"console.log(\"taxableAmount = \" + taxableAmount);",
									"",
									"var taxAmount = 0;",
									"for (let i = 0; i < lineItems.length; i++) {",
									"    taxAmount += lineItemTaxAmount[i];",
									"}",
									"console.log(\"taxAmount = \" + taxAmount);",
									"",
									"pm.test(\"Verify response code for credit note creation\", function() {",
									"    pm.response.to.have.status(201);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify credit note response body\", () => ",
									"{",
									"    pm.expect(responseJson.creditNoteId).to.be.not.null;",
									"    pm.expect(responseJson.customerCode).to.be.not.null;",
									"    pm.expect(responseJson.total).to.eql(total);",
									"    pm.expect(responseJson.taxAmount).to.eql(taxAmount);",
									"    pm.expect(responseJson.taxableAmount).to.eql(taxableAmount);",
									"    pm.expect(responseJson.documentDateTime).to.be.not.null;",
									"    pm.expect(responseJson.discountAmount).to.eql(discountAmount);",
									"    pm.expect(responseJson.exemptAmount).to.eql(0);",
									"    pm.expect(responseJson.status).to.eql(pm.collectionVariables.get(\"status\"));",
									"    pm.expect(responseJson.currency).to.eql(pm.collectionVariables.get(\"currency\"))",
									"});",
									"",
									"",
									"pm.test(\"Verify lineItems, lineItemTaxes in credit note response\", function() {",
									"    for (let i = 0; i < lineItems.length; i++) {",
									"        pm.expect(lineItems[i].amount).to.be.eql(lineItemAmount[i]);",
									"        pm.expect(lineItems[i].discountAmount).to.be.eql(lineItemDiscountAmount[i]);",
									"        pm.expect(lineItems[i].exemptAmount).to.be.eql(0);",
									"        pm.expect(lineItems[i].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"        pm.expect(lineItems[i].subtotal).to.be.eql(lineItemTaxableAmount[i]);",
									"        pm.expect(lineItems[i].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"        pm.expect(lineItems[i].total).to.be.eql(lineItemTaxableAmount[i] + lineItemTaxAmount[i]);",
									"        pm.expect(lineItems[i].itemCode).to.be.eql(pm.collectionVariables.get(\"itemCode\")[i]);",
									"        pm.expect(lineItems[i].isTaxInclusive).to.be.eql(false);",
									"        pm.expect(lineItems[i].isTaxable).to.be.eql(true);",
									"           if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"            pm.expect(lineItems[i].taxExemptType).to.be.eql(null);",
									"\t\t    pm.expect(lineItems[i].taxExemptReason).to.be.eql(null);",
									"        }",
									"        const taxes = lineItems[i].taxes;",
									"        for (let j = 0; j < taxes.length; j++) {",
									"            pm.expect(taxes[j].name).to.be.not.null;",
									"            pm.expect(taxes[j].rate).to.be.eql(Number((lineItemTaxAmount[i] * 100/lineItemTaxableAmount[i]).toFixed(2)));",
									"            pm.expect(taxes[j].taxableAmount).to.be.eql(lineItemTaxableAmount[i]);",
									"            pm.expect(taxes[j].taxAmount).to.be.eql(lineItemTaxAmount[i]);",
									"        }",
									"    }",
									"});",
									"",
									"pm.test(\"Verify sellerAddress in tax estimate response\", () => {",
									"\tconst sellerAddress = responseJson.seller.address;",
									"\tpm.expect(sellerAddress.line1).to.be.eql(pm.collectionVariables.get(\"sellerline1\"));",
									"\tpm.expect(sellerAddress.city).to.be.eql(pm.collectionVariables.get(\"sellercity\"));",
									"\tpm.expect(sellerAddress.state).to.be.eql(pm.collectionVariables.get(\"sellerstate\"));",
									"\tpm.expect(sellerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"sellerzip\"));",
									"\tpm.expect(sellerAddress.country).to.be.eql(pm.collectionVariables.get(\"sellercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"pm.test(\"Verify customerAddress in tax estimate response\", () => {",
									"\tconst customerAddress = responseJson.customer.address;",
									"\tpm.expect(customerAddress.line1).to.be.eql(pm.collectionVariables.get(\"customerline1\"));",
									"\tpm.expect(customerAddress.city).to.be.eql(pm.collectionVariables.get(\"customercity\"));",
									"\tpm.expect(customerAddress.state).to.be.eql(pm.collectionVariables.get(\"customerstate\"));",
									"\tpm.expect(customerAddress.postalCode).to.be.eql(pm.collectionVariables.get(\"customerzip\"));",
									"\tpm.expect(customerAddress.country).to.be.eql(pm.collectionVariables.get(\"customercountry\"));",
									"    if (pm.environment.get(\"currentEnvName\").has(\"Anrok\")) {",
									"        pm.expect(responseJson.seller.taxRegistrationNumber).to.be.eql(null);",
									"        pm.expect(responseJson.seller.hasNexus).to.be.eql(null);",
									"    }",
									"});",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"currency\",",
									"        \"customer\",",
									"        \"discountAmount\",",
									"        \"exemptAmount\",",
									"        \"lineItems\",",
									"        \"seller\",",
									"        \"subtotal\",",
									"        \"taxAmount\",",
									"        \"taxableAmount\",",
									"        \"total\"",
									"    ],",
									"    \"properties\": {",
									"        \"currency\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The currency Schema\"",
									"        },",
									"        \"customer\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The customer Schema\",",
									"            \"required\": [",
									"                \"address\",",
									"                \"customerCode\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\"",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\"",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\"",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\"",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\"",
									"                        }",
									"                    }",
									"                },",
									"                \"customerCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The customerCode Schema\"",
									"                }",
									"            }",
									"        },",
									"        \"discountAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The discountAmount Schema\"",
									"        },",
									"        \"estimateDateTime\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The estimateDateTime Schema\"",
									"        },",
									"        \"exemptAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The exemptAmount Schema\"",
									"        },",
									"        \"lineItems\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The lineItems Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"amount\",",
									"                    \"discountAmount\",",
									"                    \"exemptAmount\",",
									"                    \"isTaxInclusive\",",
									"                    \"isTaxable\",",
									"                    \"itemCode\",",
									"                    \"number\",",
									"                    \"subtotal\",",
									"                    \"taxAmount\",",
									"                    \"taxableAmount\",",
									"                    \"taxes\",",
									"                    \"total\"",
									"                ],",
									"                \"properties\": {",
									"                    \"amount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The amount Schema\"",
									"                    },",
									"                    \"description\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The description Schema\"",
									"                    },",
									"                    \"discountAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The discountAmount Schema\"",
									"                    },",
									"                    \"exemptAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The exemptAmount Schema\"",
									"                    },",
									"                    \"isTaxInclusive\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxInclusive Schema\"",
									"                    },",
									"                    \"isTaxable\": {",
									"                        \"type\": \"boolean\",",
									"                        \"default\": false,",
									"                        \"title\": \"The isTaxable Schema\"",
									"                    },",
									"                    \"itemCode\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The itemCode Schema\"",
									"                    },",
									"                    \"number\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The number Schema\"",
									"                    },",
									"                    \"quantity\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The quantity Schema\"",
									"                    },",
									"                    \"subtotal\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The subtotal Schema\"",
									"                    },",
									"                    \"taxAmount\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The taxAmount Schema\"",
									"                    },",
									"                    \"taxCodeFields\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxCodeFields Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"default\": {},",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"id\",",
									"                                \"value\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"id\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The id Schema\"",
									"                                },",
									"                                \"value\": {",
									"                                    \"type\": \"string\",",
									"                                    \"default\": \"\",",
									"                                    \"title\": \"The value Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"taxableAmount\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The taxableAmount Schema\"",
									"                    },",
									"                    \"taxes\": {",
									"                        \"type\": \"array\",",
									"                        \"default\": [],",
									"                        \"title\": \"The taxes Schema\",",
									"                        \"items\": {",
									"                            \"type\": \"object\",",
									"                            \"title\": \"A Schema\",",
									"                            \"required\": [",
									"                                \"jurisdiction\",",
									"                                \"name\",",
									"                                \"number\",",
									"                                \"rate\",",
									"                                \"taxAmount\",",
									"                                \"taxableAmount\"",
									"                            ],",
									"                            \"properties\": {",
									"                                \"jurisdiction\": {",
									"                                    \"type\": \"object\",",
									"                                    \"title\": \"The jurisdiction Schema\",",
									"                                    \"required\": [",
									"                                        \"code\",",
									"                                        \"name\",",
									"                                        \"type\"",
									"                                    ],",
									"                                    \"properties\": {",
									"                                        \"code\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The code Schema\"",
									"                                        },",
									"                                        \"name\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The name Schema\"",
									"                                        },",
									"                                        \"type\": {",
									"                                            \"type\": \"string\",",
									"                                            \"title\": \"The type Schema\"",
									"                                        }",
									"                                    }",
									"                                },",
									"                                \"name\": {",
									"                                    \"type\": \"string\",",
									"                                    \"title\": \"The name Schema\"",
									"                                },",
									"                                \"number\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The number Schema\"",
									"                                },",
									"                                \"rate\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The rate Schema\"",
									"                                },",
									"                                \"taxAmount\": {",
									"                                    \"type\": \"number\",",
									"                                    \"title\": \"The taxAmount Schema\"",
									"                                },",
									"                                \"taxableAmount\": {",
									"                                    \"type\": \"integer\",",
									"                                    \"title\": \"The taxableAmount Schema\"",
									"                                }",
									"                            }",
									"                        }",
									"                    },",
									"                    \"total\": {",
									"                        \"type\": \"number\",",
									"                        \"default\": 0.0,",
									"                        \"title\": \"The total Schema\",",
									"                        \"examples\": [",
									"                            10.89",
									"                        ]",
									"                    },",
									"                    \"unitPrice\": {",
									"                        \"type\": \"integer\",",
									"                        \"default\": 0,",
									"                        \"title\": \"The unitPrice Schema\",",
									"                        \"examples\": [",
									"                            10",
									"                        ]",
									"                    }",
									"                }",
									"            }",
									"        },",
									"        \"seller\": {",
									"            \"type\": \"object\",",
									"            \"default\": {},",
									"            \"title\": \"The seller Schema\",",
									"            \"required\": [",
									"                \"address\"",
									"            ],",
									"            \"properties\": {",
									"                \"address\": {",
									"                    \"type\": \"object\",",
									"                    \"default\": {},",
									"                    \"title\": \"The address Schema\",",
									"                    \"required\": [",
									"                        \"city\",",
									"                        \"country\",",
									"                        \"line1\",",
									"                        \"postalCode\",",
									"                        \"state\"",
									"                    ],",
									"                    \"properties\": {",
									"                        \"city\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The city Schema\",",
									"                            \"examples\": [",
									"                                \"San Francisco\"",
									"                            ]",
									"                        },",
									"                        \"country\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The country Schema\",",
									"                            \"examples\": [",
									"                                \"US\"",
									"                            ]",
									"                        },",
									"                        \"line1\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The line1 Schema\",",
									"                            \"examples\": [",
									"                                \"1 Dr. Carlton B. Goodlett Place\"",
									"                            ]",
									"                        },",
									"                        \"postalCode\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The postalCode Schema\",",
									"                            \"examples\": [",
									"                                \"94102\"",
									"                            ]",
									"                        },",
									"                        \"state\": {",
									"                            \"type\": \"string\",",
									"                            \"default\": \"\",",
									"                            \"title\": \"The state Schema\",",
									"                            \"examples\": [",
									"                                \"CA\"",
									"                            ]",
									"                        }",
									"                    },",
									"                    \"examples\": [{",
									"                        \"city\": \"San Francisco\",",
									"                        \"country\": \"US\",",
									"                        \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                        \"postalCode\": \"94102\",",
									"                        \"state\": \"CA\"",
									"                    }]",
									"                },",
									"                \"companyCode\": {",
									"                    \"type\": \"string\",",
									"                    \"default\": \"\",",
									"                    \"title\": \"The companyCode Schema\",",
									"                    \"examples\": [",
									"                        \"1234\"",
									"                    ]",
									"                }",
									"            },",
									"            \"examples\": [{",
									"                \"address\": {",
									"                    \"city\": \"San Francisco\",",
									"                    \"country\": \"US\",",
									"                    \"line1\": \"1 Dr. Carlton B. Goodlett Place\",",
									"                    \"postalCode\": \"94102\",",
									"                    \"state\": \"CA\"",
									"                },",
									"                \"companyCode\": \"1234\"",
									"            }]",
									"        },",
									"        \"subtotal\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The subtotal Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"taxAmount\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The taxAmount Schema\",",
									"            \"examples\": [",
									"                0.89",
									"            ]",
									"        },",
									"        \"taxableAmount\": {",
									"            \"type\": \"integer\",",
									"            \"default\": 0,",
									"            \"title\": \"The taxableAmount Schema\",",
									"            \"examples\": [",
									"                10",
									"            ]",
									"        },",
									"        \"total\": {",
									"            \"type\": \"number\",",
									"            \"default\": 0.0,",
									"            \"title\": \"The total Schema\",",
									"            \"examples\": [",
									"                10.89",
									"            ]",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Validate invoice response schema\", () => {",
									"pm.response.to.have.jsonSchema(schema);",
									"});",
									"",
									"const sentValues = pm.collectionVariables.set('InvoiceId',responseJson.invoiceId)",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set(\"line_item_unit_price\", [10]);",
									"pm.collectionVariables.set(\"line_item_discount_amount\", [0]);",
									"pm.collectionVariables.set(\"itemCode\", [\"CB-Flat-Fee-Plan-USD-Monthly\"]);",
									"pm.collectionVariables.set(\"line_item_quantity\", 1.0);",
									"pm.collectionVariables.set(\"line_item_amount\", [pm.collectionVariables.get(\"line_item_unit_price\")[0] * Number(pm.variables.get(\"line_item_quantity\"))]);",
									"",
									"",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"creditNoteCode\": \"{{$randomBankAccount}}\",\n    \"invoiceCode\": \"{{invoiceCode}}\",\n    \"creditNoteType\": \"FULL\",\n    \"documentDateTime\": \"2022-12-13T10:58:23+05:30\",\n    \"currency\": \"USD\",\n    \"seller\": {\n        \"address\": {\n            \"line1\": \"{{sellerline1}}\",\n            \"city\": \"{{sellercity}}\",\n            \"state\": \"{{sellerstate}}\",\n            \"postalCode\": \"{{sellerzip}}\",\n            \"country\": \"{{sellercountry}}\"\n        }\n    },\n    \"customer\": {\n        \"customerCode\": \"1mGG6gfTN9SCKMVmW\",\n        \"address\": {\n            \"line1\": \"{{customerline1}}\",\n            \"city\": \"{{customercity}}\",\n            \"state\": \"{{customerstate}}\",\n            \"postalCode\": \"{{customerzip}}\",\n            \"country\": \"{{customercountry}}\"\n        }\n    },\n    \"total\": 10.89,\n    \"subTotal\": 10.0,\n    \"exemptAmount\": 0,\n    \"discountAmount\": 0,\n    \"taxableAmount\": 10,\n    \"taxAmount\": 0.89,\n    \"lineItems\": [\n        {\n            \"number\": 1,\n            \"amount\": {{line_item_amount}},\n            \"subtotal\": {{subtotal}},\n            \"exemptAmount\": {{exemptAmount}},\n            \"itemCode\": \"{{itemCode}}\",\n            \"discountAmount\": {{line_item_discount_amount}},\n            \"taxableAmount\": {{taxableAmount}},\n            \"taxAmount\": 0.89,\n            \"total\": {{total}},\n            \"isTaxInclusive\": false,\n            \"isTaxable\": true,\n            \"taxes\": [\n                {\n                    \"number\": 1,\n                    \"jurisdiction\": {\n                        \"name\": \"{{jurisdictionName}}\",\n                        \"code\": \"{{jurisdictionCode}}\",\n                        \"type\": \"{{jurisdictionType}}\"\n                    },\n                    \"name\": \"Tax\",\n                    \"rate\": 8.9,\n                    \"taxableAmount\": {{taxableAmount}},\n                    \"taxAmount\": 0.89\n                }\n            ]\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/credit-notes"
					},
					"response": []
				},
				{
					"name": "Get Credit Note ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": "https://{{url}}/invoices/{{Cred}}/void"
					},
					"response": []
				},
				{
					"name": "Void Credit Note",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Credit Note is Voided\", function () {",
									"    pm.response.to.have.status(204);",
									"",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"url": "https://{{url}}/credit-notes/{{creditNoteId}}/void"
					},
					"response": []
				},
				{
					"name": "check taxability with valid address",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Verify response code in check taxability with valid address\", function() {",
									"\tpm.response.to.have.status(200);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify check taxability with valid address response body\", () => {",
									"\tconst responseJson = pm.response.json();",
									"\tpm.expect(responseJson.isTaxable).to.be.eql(true);",
									"});",
									"",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"isTaxable\"",
									"    ],",
									"    \"properties\": {",
									"        \"isTaxable\": {",
									"            \"type\": \"boolean\",",
									"            \"default\": false,",
									"            \"title\": \"The isTaxable Schema\"",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify check taxability with valid address response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"address\": {\n    \"line1\": \"\",\n    \"line2\": \"\",\n    \"line3\": \"\",\n    \"city\": \"Dallas\",\n    \"state\": \"TX\",\n    \"country\": \"US\",\n    \"postalCode\": \"75019\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/address/check-taxability"
					},
					"response": []
				},
				{
					"name": "check taxability with invalid address1",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Verify response code in check taxability with invalid address\", function() {",
									"\tpm.response.to.have.status(400);",
									"    console.log(pm.response.json());",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"address\": {\n    \"line1\": \"\",\n    \"line2\": \"\",\n    \"line3\": \"\",\n    \"city\": \"Miowaukee\",\n    \"state\": \"ON\",\n    \"country\": \"US\",\n    \"postalCode\": \"\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/address/check-taxability"
					},
					"response": []
				},
				{
					"name": "check taxability with invalid address2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Verify response code in check taxability with invalid address\", function() {",
									"\tpm.response.to.have.status(400);",
									"    console.log(pm.response.json());",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"address\": {\n    \"line1\": \"\",\n    \"line2\": \"\",\n    \"line3\": \"\",\n    \"city\": \"\",\n    \"state\": \"OH\",\n    \"country\": \"US\",\n    \"postalCode\": \"10255\"\n  }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": "https://{{url}}/address/check-taxability"
					},
					"response": []
				},
				{
					"name": "Health",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();",
									"",
									"pm.test(\"Verify health status response code\", function() {",
									"\tpm.response.to.have.status(200);",
									"    console.log(pm.response.json());",
									"});",
									"",
									"pm.test(\"Verify health status response body\", () => {",
									"\tpm.expect(responseJson.version).to.be.not.null;",
									"\tpm.expect(responseJson.description).to.eql('Anrok');",
									"\tpm.expect(responseJson.status).to.eql('UP');",
									"\tpm.expect(responseJson.time).to.be.not.null;",
									"});",
									"",
									"pm.test(\"Verify components health status in response\", () => {",
									"\tconst componentsJson = responseJson.components[0];",
									"\tpm.expect(componentsJson.id).to.eql('tax-service-adapter');",
									"\tpm.expect(componentsJson.name).to.eql('Tax Service Adapter');",
									"\tpm.expect(componentsJson.type).to.eql('ADAPTER');",
									"\tpm.expect(componentsJson.status).to.eql('UP');",
									"});",
									"",
									"",
									"var schema = {",
									"    \"$id\": \"http://example.com/example.json\",",
									"    \"type\": \"object\",",
									"    \"default\": {},",
									"    \"title\": \"Root Schema\",",
									"    \"required\": [",
									"        \"version\",",
									"        \"description\",",
									"        \"status\",",
									"        \"time\",",
									"        \"components\"",
									"    ],",
									"    \"properties\": {",
									"        \"version\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The version Schema\"",
									"        },",
									"        \"description\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The description Schema\"",
									"        },",
									"        \"status\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The status Schema\"",
									"        },",
									"        \"time\": {",
									"            \"type\": \"string\",",
									"            \"default\": \"\",",
									"            \"title\": \"The time Schema\"",
									"        },",
									"        \"components\": {",
									"            \"type\": \"array\",",
									"            \"default\": [],",
									"            \"title\": \"The components Schema\",",
									"            \"items\": {",
									"                \"type\": \"object\",",
									"                \"default\": {},",
									"                \"title\": \"A Schema\",",
									"                \"required\": [",
									"                    \"id\",",
									"                    \"name\",",
									"                    \"type\",",
									"                    \"status\"",
									"                ],",
									"                \"properties\": {",
									"                    \"id\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The id Schema\"",
									"                    },",
									"                    \"name\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The name Schema\"",
									"                    },",
									"                    \"type\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The type Schema\"",
									"                    },",
									"                    \"status\": {",
									"                        \"type\": \"string\",",
									"                        \"default\": \"\",",
									"                        \"title\": \"The status Schema\"",
									"                    }",
									"                }",
									"            }",
									"        }",
									"    }",
									"};",
									"",
									"pm.test(\"Verify health status response schema\", () => {",
									"\tpm.response.to.have.jsonSchema(schema);",
									"});",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "{{apikey}}",
								"type": "text"
							}
						],
						"url": "https://{{url}}/health"
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"pm.environment.set(\"currentEnvName\", pm.environment.name);",
					"var environmentName = pm.environment.get(\"currentEnvName\");",
					"console.log(\"Environement Name Current Used Is : \" + environmentName);",
					"",
					"pm.environment.set(\"jurisdictionName\", [\"United States\"]);",
					"pm.environment.set(\"jurisdictionCode\", [\"US\"]);",
					"pm.environment.set(\"jurisdictionType\", [\"COUNTRY\"]);",
					"pm.environment.set(\"taxRate\", 8.875);",
					"pm.environment.set(\"exemptTaxRate\", 0);",
					"",
					"pm.collectionVariables.set(\"sellerline1\", \"3444, Eglinton Avenue\");",
					"pm.collectionVariables.set(\"sellercity\", \"Toronto\");",
					"pm.collectionVariables.set(\"sellerstate\", \"ON\");",
					"pm.collectionVariables.set(\"sellerzip\", \"M4P 1A6\");",
					"pm.collectionVariables.set(\"sellercountry\", \"CA\");",
					"",
					"pm.collectionVariables.set(\"customerline1\", \"20 W 34th St\");",
					"pm.collectionVariables.set(\"customercity\", \"New York\");",
					"pm.collectionVariables.set(\"customerstate\", \"NY\");",
					"pm.collectionVariables.set(\"customerzip\", \"10001\");",
					"pm.collectionVariables.set(\"customercountry\", \"US\");",
					"",
					"pm.collectionVariables.set(\"seller_taxreg_num\", \"123456789\");",
					"pm.collectionVariables.set(\"customer_taxreg_num\", \"12-3456789\");",
					"pm.collectionVariables.set(\"currency\", \"USD\");",
					"pm.collectionVariables.set(\"taxExemptType\", \"PRODUCT_EXEMPT\");"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "CreditNoteId",
			"value": "abc"
		},
		{
			"key": "InvoiceId",
			"value": "abctest"
		},
		{
			"key": "customer_taxreg_num",
			"value": "12-3456789",
			"type": "string"
		},
		{
			"key": "seller_taxreg_num",
			"value": "123456789",
			"type": "string"
		},
		{
			"key": "line_item_unit_price",
			"value": ""
		},
		{
			"key": "line_item_discount_amount",
			"value": ""
		},
		{
			"key": "itemCode",
			"value": ""
		},
		{
			"key": "currency",
			"value": ""
		},
		{
			"key": "line_item_quantity",
			"value": ""
		},
		{
			"key": "line_item_amount",
			"value": ""
		},
		{
			"key": "sellerline1",
			"value": ""
		},
		{
			"key": "sellercity",
			"value": ""
		},
		{
			"key": "sellerstate",
			"value": ""
		},
		{
			"key": "sellerzip",
			"value": ""
		},
		{
			"key": "sellercountry",
			"value": ""
		},
		{
			"key": "customerline1",
			"value": ""
		},
		{
			"key": "customercity",
			"value": ""
		},
		{
			"key": "customerstate",
			"value": ""
		},
		{
			"key": "customerzip",
			"value": ""
		},
		{
			"key": "jurisdictionName",
			"value": ""
		},
		{
			"key": "jurisdictionCode",
			"value": ""
		},
		{
			"key": "jurisdictionType",
			"value": ""
		},
		{
			"key": "CreditNoteID",
			"value": ""
		},
		{
			"key": "status",
			"value": "COMMITTED",
			"type": "string"
		},
		{
			"key": "itemCode1",
			"value": "",
			"type": "string"
		},
		{
			"key": "taxRate",
			"value": ""
		},
		{
			"key": "line_item_amount1",
			"value": "20",
			"type": "string"
		},
		{
			"key": "exemptAmount1",
			"value": "10",
			"type": "string"
		},
		{
			"key": "exemptAmount2",
			"value": "20",
			"type": "string"
		},
		{
			"key": "taxExemptType",
			"value": "",
			"type": "string"
		},
		{
			"key": "taxExemptReason",
			"value": "not collecting tax for product",
			"type": "string",
			"disabled": true
		},
		{
			"key": "customercountry",
			"value": ""
		},
		{
			"key": "InvoiceCode",
			"value": "",
			"type": "string"
		},
		{
			"key": "subtotal",
			"value": "",
			"type": "string"
		},
		{
			"key": "exemptAmount",
			"value": "",
			"type": "string"
		},
		{
			"key": "taxableAmount",
			"value": "",
			"type": "string"
		},
		{
			"key": "total",
			"value": "",
			"type": "string"
		},
		{
			"key": "customerCode",
			"value": "",
			"type": "string"
		},
		{
			"key": "creditNoteID",
			"value": "bhnb",
			"type": "string"
		},
		{
			"key": "line_item_subtotal",
			"value": "10",
			"type": "string",
			"disabled": true
		},
		{
			"key": "line_item_total",
			"value": "",
			"type": "string",
			"disabled": true
		}
	]
}